<div class="favorites-container">
  <!-- Enhanced Header -->
  <div class="favorites-header">
    <div class="header-content">
      <div class="header-title-section">
        <h1 class="favorites-title">
          <i class="fas fa-heart"></i>
          {{ 'dashboard.favorites.title' | translate }}
        </h1>
        <p class="favorites-subtitle">{{ 'dashboard.favorites.subtitle' | translate }}</p>
      </div>
      <div class="favorites-count-badge">
        <span class="count-number">{{ favorites.length }}</span>
        <span class="count-label">{{ 'dashboard.favorites.properties' | translate }}</span>
      </div>
    </div>

    <!-- Enhanced Tabs -->
    <div class="favorites-tabs">
      <div class="tab active">
        <i class="fas fa-bookmark"></i>
        {{ 'dashboard.favorites.saved_properties' | translate }}
        <span class="tab-badge">{{ favorites.length }}</span>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div class="empty-favorites" *ngIf="favorites.length === 0">
    <div class="empty-state-card">
      <div class="empty-icon">
        <i class="fas fa-heart-broken"></i>
      </div>
      <h3>{{ 'dashboard.favorites.empty_title' | translate }}</h3>
      <p>{{ 'dashboard.favorites.empty_description' | translate }}</p>
      <button class="btn-explore" routerLink="/properties">
        <i class="fas fa-search"></i>
        {{ 'dashboard.favorites.explore_properties' | translate }}
      </button>
    </div>
  </div>

  <!-- Favorites Grid - Match Home/Land Structure -->
  <div class="favorites-grid" *ngIf="displayedFavorites.length > 0">
    <div class="property-card"
         *ngFor="let fav of displayedFavorites"
         (click)="navigateToProperty(fav.property.id)"
         [class.removing]="removingIds.has(fav.propertyId)">

      <!-- Property Image -->
      <div class="property-image">
        <img [src]="fav.property.imageUrl" [alt]="fav.property.title">

        <!-- Favorite Button -->
        <button
          type="button"
          class="favorite-btn"
          [class.active]="isFavorite(fav.propertyId)"
          (click)="toggleFavorite(fav.propertyId); $event.stopPropagation()">
          <i class="bi" [ngClass]="isFavorite(fav.propertyId) ? 'bi-heart-fill' : 'bi-heart'"></i>
        </button>

        <!-- Purpose Badge -->
        <span class="purpose-badge">{{ fav.property.purpose }}</span>

        <!-- Featured Badge (if applicable) -->
        <span class="featured-badge" *ngIf="fav.property.isFeatured">
          <i class="bi bi-star-fill"></i>
          Featured
        </span>
      </div>

      <!-- Property Info -->
      <div class="property-info">
        <div class="property-header">
          <h3 class="property-title">{{ fav.property.title }}</h3>
          <p class="property-location">
            <i class="bi bi-geo-alt-fill"></i>
            {{ fav.property.area }}, {{ fav.property.city }}
          </p>
        </div>

        <div class="property-details">
          <span class="detail-item">
            <i class="bi bi-door-open-fill"></i>
            {{ fav.property.rooms }} {{ 'property.beds' | translate }}
          </span>
          <span class="detail-item">
            <i class="bi bi-droplet-fill"></i>
            {{ fav.property.bathrooms }} {{ 'property.baths' | translate }}
          </span>
          <span class="detail-item">
            <i class="bi bi-arrows-fullscreen"></i>
            {{ fav.property.area }} mÂ²
          </span>
        </div>

        <div class="property-footer">
          <div class="property-price">
            <span class="price-value">{{ fav.property.price | currency:'EGP':'symbol':'1.0-0' }}</span>
            <span class="price-period" *ngIf="fav.property.purpose === 'Rent'">{{ 'dashboard.favorites.month' | translate }}</span>
          </div>

          <div class="property-contact-actions">
            <a
              class="contact-icon-btn whatsapp-btn"
              title="Contact on WhatsApp"
              aria-label="Contact via WhatsApp"
              [href]="'https://wa.me/' + phone.replace(/\D/g, '')"
              target="_blank"
              rel="noopener noreferrer"
              (click)="$event.stopPropagation()">
              <i class="bi bi-whatsapp"></i>
            </a>
            <a
              class="contact-icon-btn phone-btn"
              [href]="'tel:' + phone"
              title="Call Now"
              aria-label="Call seller"
              (click)="$event.stopPropagation()">
              <i class="bi bi-telephone-fill"></i>
            </a>
            <a
              class="contact-icon-btn email-btn"
              [href]="'mailto:' + email"
              title="Email"
              aria-label="Email seller"
              (click)="$event.stopPropagation()">
              <i class="bi bi-envelope-fill"></i>
            </a>
            <button
              type="button"
              class="view-details-btn"
              [routerLink]="['/property', fav.property.id]"
              (click)="$event.stopPropagation()">
              <i class="bi bi-eye"></i>
              View
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- See More Button -->
  <div class="favorites-controls" *ngIf="favorites.length > 0">
    <div class="see-more-section" *ngIf="hasMoreToLoad()">
      <button type="button" class="see-more-btn" (click)="loadMore()">
        {{ 'common.see_more' | translate }}
        <i class="bi bi-arrow-down"></i>
      </button>
    </div>

    <!-- Delete All Button -->
    <div class="delete-all-section">
      <button class="delete-all-btn" (click)="deleteAll()">
        <i class="fas fa-trash-alt"></i>
        {{ 'dashboard.favorites.clear_all_favorites' | translate }}
      </button>
    </div>
  </div>
</div>
