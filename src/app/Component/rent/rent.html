<!-- Hero Section -->
<section class="hero-section">
  <div class="hero-overlay"></div>
  <div class="hero-content-wrapper">
    <div class="hero-text-content">
      <h1 class="hero-main-title">{{ 'home.rent.hero_title' | translate }}</h1>
      <p class="hero-description">{{ 'home.rent.hero_description' | translate }}</p>

      <!-- Search Box in Hero -->
      <div class="hero-search-box">
        <form [formGroup]="searchForm" (ngSubmit)="onSearch()" class="hero-search-form">
          <div class="search-fields-wrapper">
            <!-- City Input -->
            <div class="search-field-hero">
              <i class="bi bi-geo-alt"></i>
              <input
                type="text"
                formControlName="city"
                [placeholder]="'home.rent.city_placeholder' | translate"
                class="search-input-hero">
            </div>

            <!-- Property Type Dropdown -->
            <div class="search-field-hero dropdown-wrapper">
              <i class="bi bi-house-door"></i>
              <input
                type="text"
                formControlName="propertyType"
                [placeholder]="'home.rent.property_type_placeholder' | translate"
                class="search-input-hero"
                readonly
                (click)="togglePropertyTypeDropdown()">
              <i class="bi bi-chevron-down toggle-icon"></i>

              <div class="dropdown-menu-hero" *ngIf="showPropertyTypeDropdown">
                <div class="dropdown-item-hero" (click)="searchForm.patchValue({propertyType: 'Apartment'}); showPropertyTypeDropdown = false">
                  <i class="bi bi-building"></i>
                  {{ 'property.apartment' | translate }}
                </div>
                <div class="dropdown-item-hero" (click)="searchForm.patchValue({propertyType: 'Villa'}); showPropertyTypeDropdown = false">
                  <i class="bi bi-house"></i>
                  {{ 'property.villa' | translate }}
                </div>
                <div class="dropdown-item-hero" (click)="searchForm.patchValue({propertyType: 'Land'}); showPropertyTypeDropdown = false">
                  <i class="bi bi-house-door"></i>
                  {{ 'property.land' | translate }}
                </div>
              </div>
            </div>

            <!-- Rooms Dropdown -->
            <div class="search-field-hero dropdown-wrapper">
              <i class="bi bi-door-open"></i>
              <input
                type="text"
                formControlName="rooms"
                [placeholder]="'property.bedrooms' | translate"
                class="search-input-hero"
                readonly
                (click)="toggleBedsAndBathsDropdown()">
              <i class="bi bi-chevron-down toggle-icon"></i>

              <div class="dropdown-menu-hero" *ngIf="showBedsAndBathsDropdown">
                <div class="dropdown-item-hero" (click)="searchForm.patchValue({rooms: '1'}); showBedsAndBathsDropdown = false">
                  <i class="bi bi-1-circle"></i>
                  {{ '1' }} {{ 'property.bedroom' | translate }}
                </div>
                <div class="dropdown-item-hero" (click)="searchForm.patchValue({rooms: '2'}); showBedsAndBathsDropdown = false">
                  <i class="bi bi-2-circle"></i>
                  {{ '2' }} {{ 'property.bedrooms' | translate }}
                </div>
                <div class="dropdown-item-hero" (click)="searchForm.patchValue({rooms: '3'}); showBedsAndBathsDropdown = false">
                  <i class="bi bi-3-circle"></i>
                  {{ '3' }} {{ 'property.bedrooms' | translate }}
                </div>
                <div class="dropdown-item-hero" (click)="searchForm.patchValue({rooms: '4'}); showBedsAndBathsDropdown = false">
                  <i class="bi bi-4-circle"></i>
                  {{ '4+' }} {{ 'property.bedrooms' | translate }}
                </div>
              </div>
            </div>

            <!-- Search Button -->
            <button type="submit" class="search-btn-hero" title="Search">
              <i class="bi bi-search"></i>
            </button>

            <!-- Clear Button -->
            <button type="button" class="search-btn-hero clear-btn" title="Clear all filters" (click)="clearAllFilters()">
              Clear Search
            </button>
          </div>
        </form>

        <!-- Quick Search -->
        <div class="quick-search-hero">
          <span class="quick-label">{{ 'home.rent.popular' | translate }}: </span>
          <button type="button" class="quick-btn-hero" (click)="setQuickSearch('Cairo')">{{ 'home.rent.cairo' | translate }}</button>
          <button type="button" class="quick-btn-hero" (click)="setQuickSearch('Alexandria')">{{ 'home.rent.alexandria' | translate }}</button>
          <button type="button" class="quick-btn-hero" (click)="setQuickSearch('Giza')">{{ 'home.rent.giza' | translate }}</button>
          <button type="button" class="quick-btn-hero" (click)="setQuickSearch('New Cairo')">{{ 'home.rent.new_cairo' | translate }}</button>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Filters & Properties Section -->
<section class="properties-main-section">
  <div class="container-full">
    <div class="main-layout">

      <!-- Properties Grid -->
      <div class="properties-content">
        <div class="properties-header">
          <h2 class="properties-count">
            <span class="count-number">{{ rentProperties.length }}</span> {{ 'home.rent.properties_found' | translate }}
            <span class="page-info" *ngIf="displayedProperties.length > 0">
              ({{ 'home.rent.showing' | translate }} {{ displayedProperties.length }} {{ 'home.rent.of' | translate }} {{ rentProperties.length }})
            </span>
          </h2>
          <div class="view-toggle">
            <button type="button" class="view-btn active" title="Grid View"><i class="bi bi-grid-3x3-gap"></i></button>
            <button type="button" class="view-btn" title="List View"><i class="bi bi-list"></i></button>
          </div>
        </div>

        <!-- Properties Grid -->
        <div class="properties-grid" *ngIf="displayedProperties.length > 0">
          <div
            class="property-card"
            *ngFor="let property of displayedProperties; trackBy: trackById">

            <!-- Property Image -->
            <div class="property-image">
              <img [src]="property.imageUrl || 'https://images.unsplash.com/photo-1560518883-ce09059eeffa?w=400'"
                   [alt]="property.title">

              <!-- Favorite Button -->
              <button
                type="button"
                class="favorite-btn"
                [class.active]="isFavorite(property.id)"
                (click)="toggleFavorite(property.id); $event.stopPropagation()">
                <i class="bi" [ngClass]="isFavorite(property.id) ? 'bi-heart-fill' : 'bi-heart'"></i>
              </button>

              <!-- Purpose Badge -->
              <span class="purpose-badge rent">{{ 'property.for_rent' | translate }}</span>

              <!-- Featured Badge -->
              <span class="featured-badge" *ngIf="property.isFeatured">
                <i class="bi bi-star-fill"></i>
                {{ 'property.featured' | translate }}
              </span>
            </div>

            <!-- Property Info -->
            <div class="property-info">
              <div class="property-header">
                <h3 class="property-title">{{ property.title }}</h3>
                <h3 class="property-title">{{ property.propertyType }}</h3>
                <p class="property-location">
                  <i class="bi bi-geo-alt-fill"></i>
                  {{ property.area }}, {{ property.city }}
                </p>
              </div>

              <div class="property-details">
                <span class="detail-item">
                  <i class="bi bi-door-open-fill"></i>
                  {{ property.rooms }} {{ 'property.card.beds' | translate }}
                </span>
                <span class="detail-item">
                  <i class="bi bi-droplet-fill"></i>
                  {{ property.bathrooms }} {{ 'property.card.baths' | translate }}
                </span>
                <span class="detail-item">
                  <i class="bi bi-arrows-fullscreen"></i>
                  {{ property.areaSpace }} mÂ²
                </span>
              </div>

              <div class="property-footer">
                <div class="property-price">
                  <span class="price-value">{{ property.price | currency:'EGP':'symbol':'1.0-0' }}</span>
                  <span class="price-period">{{ 'property.month' | translate }}</span>
                </div>
                <div class="property-contact-actions">
                  <a
                    class="contact-icon-btn whatsapp-btn"
                    title="Contact on WhatsApp"
                    aria-label="Contact via WhatsApp"
                    [href]="'https://wa.me/' + phone.replace(/\D/g, '')"
                    target="_blank"
                    rel="noopener noreferrer"
                    (click)="$event.stopPropagation()">
                    <i class="bi bi-whatsapp"></i>
                  </a>
                  <button
                    type="button"
                    class="contact-icon-btn phone-btn"
                    title="Call Now"
                    aria-label="Call seller"
                    (click)="showCallModal(); $event.stopPropagation()">
                    <i class="bi bi-telephone-fill"></i>
                  </button>
                  <a
                    class="contact-icon-btn email-btn"
                    [href]="'mailto:' + email"
                    title="Email"
                    aria-label="Email seller"
                    (click)="$event.stopPropagation()">
                    <i class="bi bi-envelope-fill"></i>
                  </a>
                  <button
                    type="button"
                    class="view-details-btn"
                    [routerLink]="['/property', property.id]"
                    (click)="$event.stopPropagation()">
                    <i class="bi bi-eye"></i>
                    View
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- No Results -->
        <div class="no-results" *ngIf="rentProperties.length === 0">
          <div class="no-results-icon">
            <i class="bi bi-search"></i>
          </div>
          <h3>{{ 'home.rent.no_properties_found' | translate }}</h3>
          <p>{{ 'home.rent.try_adjusting_filters' | translate }}</p>
          <button type="button" class="reset-filters-btn" (click)="clearAllFilters()">{{ 'home.rent.reset_filters' | translate }}</button>
        </div>

        <!-- See More Button -->
        <div class="see-more-section" *ngIf="hasMoreToLoad()">
          <button type="button" class="see-more-btn" (click)="loadMore()">
            {{ 'common.see_more' | translate }}
            <i class="bi bi-arrow-down"></i>
          </button>
        </div>
      </div>

      <!-- Sidebar Filters -->
      <aside class="filters-sidebar">
        <div class="filters-header">
          <h3>{{ 'home.rent.filters' | translate }}</h3>
          <button type="button" class="clear-filters" (click)="clearAllFilters()">{{ 'home.rent.clear_all' | translate }}</button>
        </div>

        <div class="filter-group">
          <h4 class="filter-title">
            <i class="bi bi-sort-down"></i>
            {{ 'home.rent.sort_by' | translate }}
          </h4>
          <div class="filter-options">
            <label class="filter-option">
              <input type="radio" name="sort" value="newest" (change)="onFilterChange($event)">
              <span>{{ 'home.rent.newest_first' | translate }}</span>
            </label>
            <label class="filter-option">
              <input type="radio" name="sort" value="price-low" (change)="onFilterChange($event)">
              <span>{{ 'home.rent.price_low_to_high' | translate }}</span>
            </label>
            <label class="filter-option">
              <input type="radio" name="sort" value="price-high" (change)="onFilterChange($event)">
              <span>{{ 'home.rent.price_high_to_low' | translate }}</span>
            </label>
            <label class="filter-option">
              <input type="radio" name="sort" value="popular" (change)="onFilterChange($event)">
              <span>{{ 'home.rent.most_popular' | translate }}</span>
            </label>
          </div>
        </div>

        <div class="filter-group">
          <h4 class="filter-title">
            <i class="bi bi-house"></i>
            {{ 'property.property_type' | translate }}
          </h4>
          <div class="filter-options">
            <label class="filter-option">
              <input type="checkbox" value="apartment" (change)="onFilterChange($event)">
              <span>{{ 'property.apartment' | translate }}</span>
            </label>
            <label class="filter-option">
              <input type="checkbox" value="villa" (change)="onFilterChange($event)">
              <span>{{ 'property.villa' | translate }}</span>
            </label>
            <label class="filter-option">
              <input type="checkbox" value="land" (change)="onFilterChange($event)">
              <span>{{ 'property.land' | translate }}</span>
            </label>
          </div>
        </div>

        <div class="filter-group">
          <h4 class="filter-title">
            <i class="bi bi-currency-dollar"></i>
            {{ 'home.rent.price_range' | translate }}
          </h4>
          <div class="price-inputs">
            <input type="number" placeholder="Min" class="price-input" (change)="onPriceFilterChange()">
            <span class="price-separator">-</span>
            <input type="number" placeholder="Max" class="price-input" (change)="onPriceFilterChange()">
          </div>
        </div>

        <div class="filter-group">
          <h4 class="filter-title">
            <i class="bi bi-arrows-fullscreen"></i>
            {{ 'home.rent.area' | translate }}
          </h4>
          <div class="filter-options">
            <label class="filter-option">
              <input type="checkbox" value="under100" (change)="onFilterChange($event)">
              <span>{{ 'home.rent.under_100' | translate }}</span>
            </label>
            <label class="filter-option">
              <input type="checkbox" value="100-200" (change)="onFilterChange($event)">
              <span>{{ 'home.rent.range_100_200' | translate }}</span>
            </label>
            <label class="filter-option">
              <input type="checkbox" value="200-300" (change)="onFilterChange($event)">
              <span>{{ 'home.rent.range_200_300' | translate }}</span>
            </label>
            <label class="filter-option">
              <input type="checkbox" value="300plus" (change)="onFilterChange($event)">
              <span>{{ 'home.rent.range_300_plus' | translate }}</span>
            </label>
          </div>
        </div>

        <div class="filter-group">
          <h4 class="filter-title">
            <i class="bi bi-door-open"></i>
            {{ 'property.bedrooms' | translate }}
          </h4>
          <div class="filter-options">
            <label class="filter-option">
              <input type="checkbox" value="1" (change)="onFilterChange($event)">
              <span>{{ '1' }} {{ 'property.bedroom' | translate }}</span>
            </label>
            <label class="filter-option">
              <input type="checkbox" value="2" (change)="onFilterChange($event)">
              <span>{{ '2' }} {{ 'property.bedrooms' | translate }}</span>
            </label>
            <label class="filter-option">
              <input type="checkbox" value="3" (change)="onFilterChange($event)">
              <span>{{ '3' }} {{ 'property.bedrooms' | translate }}</span>
            </label>
            <label class="filter-option">
              <input type="checkbox" value="4plus" (change)="onFilterChange($event)">
              <span>{{ '4+' }} {{ 'property.bedrooms' | translate }}</span>
            </label>
          </div>
        </div>
      </aside>
    </div>
  </div>
</section>
<!-- Call Modal -->
<div class="call-modal" *ngIf="showCallModalFlag">
  <div class="call-modal-content">
    <h4>{{ 'property.call_us' | translate }}</h4>
    <p>{{ phone }}</p>
    <button (click)="makeCall()">{{ 'common.call_now' | translate }}</button>
    <button (click)="closeCallModal()">{{ 'common.close' | translate }}</button>
  </div>
</div>
