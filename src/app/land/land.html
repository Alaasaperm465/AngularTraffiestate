<div class="land-container">

  <!-- ================= HERO ================= -->
  <section class="land-hero">
    <div class="hero-overlay">
      <h1>{{ 'land.hero.title' | translate }}</h1>
      <p>{{ 'land.hero.description' | translate }}</p>
    </div>
  </section>

  <!-- ================= SEARCH ================= -->
  <section class="search-section">
    <form class="search-container" [formGroup]="searchForm" (ngSubmit)="onSearch()">
      <div class="search-grid">

        <!-- City / Area -->
        <div class="search-group">
          <label>
            <i class="bi bi-geo-alt"></i>
            {{ 'land.search.city_area' | translate }}
          </label>
          <input
            type="text"
            [placeholder]="'land.search.city_placeholder' | translate"
            formControlName="city"
          />
        </div>

        <!-- Property Type (Fixed: Land) -->
        <div class="search-group">
          <label>
            <i class="bi bi-layers"></i>
            {{ 'land.search.property_type' | translate }}
          </label>
          <div class="type-display">
            <i class="bi bi-tree"></i>
            {{ 'land.search.land' | translate }}
          </div>
        </div>

        <!-- Land Size -->
        <div class="search-group">
          <label>
            <i class="bi bi-aspect-ratio"></i>
            {{ 'land.search.size_sqm' | translate }}
          </label>
          <div class="range-inputs">
            <input type="number" [placeholder]="'land.search.min_size' | translate" formControlName="minSize" min="0" />
            <span>-</span>
            <input type="number" [placeholder]="'land.search.max_size' | translate" formControlName="maxSize" min="0" />
          </div>
        </div>

        <!-- Price -->
        <div class="search-group">
          <label>
            <i class="bi bi-cash-stack"></i>
            {{ 'land.search.price_egp' | translate }}
          </label>
          <div class="range-inputs">
            <input type="number" [placeholder]="'land.search.min_price' | translate" formControlName="minPrice" min="0" />
            <span>-</span>
            <input type="number" [placeholder]="'land.search.max_price' | translate" formControlName="maxPrice" min="0" />
          </div>
        </div>

        <!-- Search Button -->
        <button class="search-btn" type="submit" [title]="'land.search.search_button' | translate">
          <i class="bi bi-search"></i>
        </button>

      </div>
    </form>
  </section>

  <!-- ================= QUICK SEARCH ================= -->
  <section class="quick-search-section">
    <h3>{{ 'land.quick_search.title' | translate }}</h3>
    <div class="quick-search-grid">
      <div
        class="quick-search-item"
        *ngFor="let city of quickSearchCities"
        (click)="setQuickSearch(city.name)"
      >
        <div class="city-name">
          <i class="bi bi-geo"></i>
          {{ city.name }}
        </div>
        <span class="city-count">
          {{ getCityCount(city.name) }}
        </span>
      </div>
    </div>
  </section>

  <!-- ================= MAIN CONTENT ================= -->
  <div class="land-content">

    <!-- ========== RESULTS ========== -->
    <section class="lands-grid">

      <div class="results-header">
        <h3>
          <span class="count-number">{{ displayedProperties.length }}</span> {{ 'land.results.lands_shown' | translate }}
          <span class="page-info" *ngIf="displayedProperties.length > 0">({{ 'land.results.showing' | translate }} {{ displayedProperties.length }} {{ 'land.results.of' | translate }} {{ landProperties.length }})</span>
        </h3>
      </div>

      <!-- No Results -->
      <div class="no-results" *ngIf="landProperties.length === 0">
        <i class="bi bi-search"></i>
        <h4>{{ 'land.results.no_results' | translate }}</h4>
        <p>{{ 'land.results.try_adjusting' | translate }}</p>
      </div>

      <!-- Cards -->
      <div class="lands-grid-content" *ngIf="displayedProperties.length > 0">
        <div
          class="property-card"
          *ngFor="let land of displayedProperties; trackBy: trackById"
        >

          <!-- Property Image -->
          <div class="property-image">
            <img [src]="land.imageUrl || 'https://via.placeholder.com/400x250'" [alt]="land.title" />

            <!-- Favorite Button -->
            <button
              type="button"
              class="favorite-btn"
              [class.active]="isFavorite(land.id)"
              (click)="toggleFavorite(land.id); $event.stopPropagation()">
              <i class="bi" [ngClass]="isFavorite(land.id) ? 'bi-heart-fill' : 'bi-heart'"></i>
            </button>

            <!-- Purpose Badge -->
            <span class="purpose-badge">Land</span>
          </div>

          <!-- Property Info -->
          <div class="property-info">
            <div class="property-header">
              <h3 class="property-title">{{ land.title }}</h3>
              <p class="property-location">
                <i class="bi bi-geo-alt-fill"></i>
                {{ land.area }}, {{ land.city }}
              </p>
            </div>

            <div class="property-details">
              <span class="detail-item">
                <i class="bi bi-arrows-fullscreen"></i>
                {{ land.areaSpace }} {{ 'land.results.sqm' | translate }}
              </span>
              <span class="detail-item">
                <i class="bi bi-eye"></i>
                {{ land.views || 0 }} {{ 'land.results.views' | translate }}
              </span>
              <span class="detail-item">
                <i class="bi bi-star"></i>
                <ng-container *ngIf="land.isFeatured">{{ 'land.results.featured' | translate }}</ng-container>
                <ng-container *ngIf="!land.isFeatured">{{ 'land.results.standard' | translate }}</ng-container>
              </span>
            </div>

            <p class="property-description">
              {{ land.description | slice:0:120 }}...
            </p>

            <div class="property-footer">
              <div class="property-price">
                <span class="price-value">{{ land.price | currency:'EGP':'symbol':'1.0-0' }}</span>
                <span class="price-period">EGP</span>
              </div>
              <div class="property-contact-actions">
                <a
                  class="contact-icon-btn whatsapp-btn"
                  title="Contact on WhatsApp"
                  aria-label="Contact via WhatsApp"
                  [href]="'https://wa.me/' + phone.replace(/\D/g, '')"
                  target="_blank"
                  rel="noopener noreferrer"
                  (click)="$event.stopPropagation()">
                  <i class="bi bi-whatsapp"></i>
                </a>
                <a
                  class="contact-icon-btn phone-btn"
                  [href]="'tel:' + phone"
                  title="Call Now"
                  aria-label="Call seller"
                  (click)="$event.stopPropagation()">
                  <i class="bi bi-telephone-fill"></i>
                </a>
                <a
                  class="contact-icon-btn email-btn"
                  [href]="'mailto:' + email"
                  title="Email"
                  aria-label="Email seller"
                  (click)="$event.stopPropagation()">
                  <i class="bi bi-envelope-fill"></i>
                </a>
                <button
                  type="button"
                  class="view-details-btn"
                  [routerLink]="['/property', land.id]"
                  (click)="$event.stopPropagation()">
                  <i class="bi bi-eye"></i>
                  {{ 'land.results.view' | translate }}
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- See More Button -->
      <div class="see-more-section" *ngIf="hasMoreToLoad()">
        <button type="button" class="see-more-btn" (click)="loadMore()">
          {{ 'land.results.see_more' | translate }}
          <i class="bi bi-arrow-down"></i>
        </button>
      </div>

    </section>

    <!-- ========== FILTERS SIDEBAR ========== -->
    <aside class="filters-sidebar">
      <div class="filters-header">
        <h3>{{ 'land.filters.title' | translate }}</h3>
        <button type="button" class="clear-filters" (click)="clearAllFilters()">{{ 'land.filters.clear_all' | translate }}</button>
      </div>

      <div class="filter-section">

        <!-- Sort By -->
        <div class="filter-group">
          <h5>
            <i class="bi bi-sort-down"></i>
            {{ 'land.filters.sort_by' | translate }}
          </h5>
          <div class="filter-options">
            <div class="filter-option">
              <input
                type="radio"
                name="sort"
                value="newest"
                (change)="onFilterChange($event)"
              />
              <label>{{ 'land.filters.newest' | translate }}</label>
            </div>
            <div class="filter-option">
              <input
                type="radio"
                name="sort"
                value="price-low"
                (change)="onFilterChange($event)"
              />
              <label>{{ 'land.filters.price_low' | translate }}</label>
            </div>
            <div class="filter-option">
              <input
                type="radio"
                name="sort"
                value="price-high"
                (change)="onFilterChange($event)"
              />
              <label>{{ 'land.filters.price_high' | translate }}</label>
            </div>
            <div class="filter-option">
              <input
                type="radio"
                name="sort"
                value="popular"
                (change)="onFilterChange($event)"
              />
              <label>{{ 'land.filters.popular' | translate }}</label>
            </div>
          </div>
        </div>

        <!-- Divider -->
        <div class="filter-divider"></div>

        <!-- Land Size -->
        <div class="filter-group">
          <h5>
            <i class="bi bi-aspect-ratio"></i>
            {{ 'land.filters.size' | translate }}
          </h5>
          <div class="filter-options">
            <div class="filter-option" *ngFor="let size of landSizes">
              <input
                type="checkbox"
                [value]="size.value"
                (change)="onFilterChange($event)"
              />
              <label>{{ size.label | translate }}</label>
            </div>
          </div>
        </div>

        <!-- Divider -->
        <div class="filter-divider"></div>

        <!-- Price -->
        <div class="filter-group">
          <h5>
            <i class="bi bi-currency-dollar"></i>
            {{ 'land.filters.price' | translate }}
          </h5>
          <div class="filter-options">
            <div class="filter-option" *ngFor="let price of landPriceRanges">
              <input
                type="checkbox"
                [value]="price.value"
                (change)="onFilterChange($event)"
              />
              <label>{{ price.label | translate }}</label>
            </div>
          </div>
        </div>

      </div>
    </aside>

  </div>

</div>