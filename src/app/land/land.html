<div class="land-container">

  <!-- ================= HERO ================= -->
  <section class="land-hero">
    <div class="hero-overlay">
      <h1>Find Your Perfect Land</h1>
      <p>Discover premium land opportunities across Egypt</p>
    </div>
  </section>

  <!-- ================= SEARCH ================= -->
  <section class="search-section">
    <form class="search-container" [formGroup]="searchForm" (ngSubmit)="onSearch()">
      <div class="search-grid">

        <!-- City / Area -->
        <div class="search-group">
          <label>
            <i class="bi bi-geo-alt"></i>
            City / Area
          </label>
          <input
            type="text"
            placeholder="Cairo, Giza, New Cairo..."
            formControlName="city"
          />
        </div>

        <!-- Property Type (Fixed: Land) -->
        <div class="search-group">
          <label>
            <i class="bi bi-layers"></i>
            Property Type
          </label>
          <div class="type-display">
            <i class="bi bi-tree"></i>
            Land
          </div>
        </div>

        <!-- Land Size -->
        <div class="search-group">
          <label>
            <i class="bi bi-aspect-ratio"></i>
            Size (sqm)
          </label>
          <div class="range-inputs">
            <input type="number" placeholder="Min" formControlName="minSize" min="0" />
            <span>-</span>
            <input type="number" placeholder="Max" formControlName="maxSize" min="0" />
          </div>
        </div>

        <!-- Price -->
        <div class="search-group">
          <label>
            <i class="bi bi-cash-stack"></i>
            Price (EGP)
          </label>
          <div class="range-inputs">
            <input type="number" placeholder="Min" formControlName="minPrice" min="0" />
            <span>-</span>
            <input type="number" placeholder="Max" formControlName="maxPrice" min="0" />
          </div>
        </div>

        <!-- Search Button -->
        <button class="search-btn" type="submit" title="Search">
          <i class="bi bi-search"></i>
        </button>

      </div>
    </form>
  </section>

  <!-- ================= QUICK SEARCH ================= -->
  <section class="quick-search-section">
    <h3>Popular Locations</h3>
    <div class="quick-search-grid">
      <div
        class="quick-search-item"
        *ngFor="let city of quickSearchCities"
        (click)="setQuickSearch(city.name)"
      >
        <div class="city-name">
          <i class="bi bi-geo"></i>
          {{ city.name }}
        </div>
        <span class="city-count">
          {{ getCityCount(city.name) }}
        </span>
      </div>
    </div>
  </section>

  <!-- ================= MAIN CONTENT ================= -->
  <div class="land-content">

    <!-- ========== RESULTS ========== -->
    <section class="lands-grid">

      <div class="results-header">
        <h3>
          <span class="count-number">{{ displayedProperties.length }}</span> Lands Shown
          <span class="page-info" *ngIf="displayedProperties.length > 0">(Showing {{ displayedProperties.length }} of {{ landProperties.length }})</span>
        </h3>
      </div>

      <!-- No Results -->
      <div class="no-results" *ngIf="landProperties.length === 0">
        <i class="bi bi-search"></i>
        <h4>No lands found</h4>
        <p>Try adjusting your filters</p>
      </div>

      <!-- Cards -->
      <div class="lands-grid-content" *ngIf="displayedProperties.length > 0">
        <div
          class="property-card"
          *ngFor="let land of displayedProperties; trackBy: trackById"
        >

          <!-- Property Image -->
          <div class="property-image">
            <img [src]="land.imageUrl || 'https://via.placeholder.com/400x250'" [alt]="land.title" />

            <!-- Favorite Button -->
            <button
              type="button"
              class="favorite-btn"
              [class.active]="isFavorite(land.id)"
              (click)="toggleFavorite(land.id); $event.stopPropagation()">
              <i class="bi" [ngClass]="isFavorite(land.id) ? 'bi-heart-fill' : 'bi-heart'"></i>
            </button>

            <!-- Purpose Badge -->
            <span class="purpose-badge">Land</span>
          </div>

          <!-- Property Info -->
          <div class="property-info">
            <div class="property-header">
              <h3 class="property-title">{{ land.title }}</h3>
              <p class="property-location">
                <i class="bi bi-geo-alt-fill"></i>
                {{ land.area }}, {{ land.city }}
              </p>
            </div>

            <div class="property-details">
              <span class="detail-item">
                <i class="bi bi-arrows-fullscreen"></i>
                {{ land.areaSpace }} sqm
              </span>
              <span class="detail-item">
                <i class="bi bi-eye"></i>
                {{ land.views || 0 }} Views
              </span>
              <span class="detail-item">
                <i class="bi bi-star"></i>
                {{ land.isFeatured ? 'Featured' : 'Standard' }}
              </span>
            </div>

            <p class="property-description">
              {{ land.description | slice:0:120 }}...
            </p>

            <div class="property-footer">
              <div class="property-price">
                <span class="price-value">{{ land.price | currency:'EGP':'symbol':'1.0-0' }}</span>
                <span class="price-period">EGP</span>
              </div>
              <div class="property-contact-actions">
                <a
                  class="contact-icon-btn whatsapp-btn"
                  title="Contact on WhatsApp"
                  aria-label="Contact via WhatsApp"
                  [href]="'https://wa.me/' + phone.replace(/\D/g, '')"
                  target="_blank"
                  rel="noopener noreferrer"
                  (click)="$event.stopPropagation()">
                  <i class="bi bi-whatsapp"></i>
                </a>
                <a
                  class="contact-icon-btn phone-btn"
                  [href]="'tel:' + phone"
                  title="Call Now"
                  aria-label="Call seller"
                  (click)="$event.stopPropagation()">
                  <i class="bi bi-telephone-fill"></i>
                </a>
                <a
                  class="contact-icon-btn email-btn"
                  [href]="'mailto:' + email"
                  title="Email"
                  aria-label="Email seller"
                  (click)="$event.stopPropagation()">
                  <i class="bi bi-envelope-fill"></i>
                </a>
                <button
                  type="button"
                  class="view-details-btn"
                  [routerLink]="['/property', land.id]"
                  (click)="$event.stopPropagation()">
                  <i class="bi bi-eye"></i>
                  View
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- See More Button -->
      <div class="see-more-section" *ngIf="hasMoreToLoad()">
        <button type="button" class="see-more-btn" (click)="loadMore()">
          See More
          <i class="bi bi-arrow-down"></i>
        </button>
      </div>

    </section>

    <!-- ========== FILTERS SIDEBAR ========== -->
    <aside class="filters-sidebar">
      <div class="filters-header">
        <h3>Filters</h3>
        <button type="button" class="clear-filters" (click)="clearAllFilters()">Clear All</button>
      </div>

      <div class="filter-section">

        <!-- Sort By -->
        <div class="filter-group">
          <h5>
            <i class="bi bi-sort-down"></i>
            Sort By
          </h5>
          <div class="filter-options">
            <div class="filter-option">
              <input
                type="radio"
                name="sort"
                value="newest"
                (change)="onFilterChange($event)"
              />
              <label>Newest First</label>
            </div>
            <div class="filter-option">
              <input
                type="radio"
                name="sort"
                value="price-low"
                (change)="onFilterChange($event)"
              />
              <label>Price: Low to High</label>
            </div>
            <div class="filter-option">
              <input
                type="radio"
                name="sort"
                value="price-high"
                (change)="onFilterChange($event)"
              />
              <label>Price: High to Low</label>
            </div>
            <div class="filter-option">
              <input
                type="radio"
                name="sort"
                value="popular"
                (change)="onFilterChange($event)"
              />
              <label>Most Popular</label>
            </div>
          </div>
        </div>

        <!-- Divider -->
        <div class="filter-divider"></div>

        <!-- Land Size -->
        <div class="filter-group">
          <h5>
            <i class="bi bi-aspect-ratio"></i>
            Size
          </h5>
          <div class="filter-options">
            <div class="filter-option" *ngFor="let size of landSizes">
              <input
                type="checkbox"
                [value]="size.value"
                (change)="onFilterChange($event)"
              />
              <label>{{ size.label }}</label>
            </div>
          </div>
        </div>

        <!-- Divider -->
        <div class="filter-divider"></div>

        <!-- Price -->
        <div class="filter-group">
          <h5>
            <i class="bi bi-currency-dollar"></i>
            Price
          </h5>
          <div class="filter-options">
            <div class="filter-option" *ngFor="let price of landPriceRanges">
              <input
                type="checkbox"
                [value]="price.value"
                (change)="onFilterChange($event)"
              />
              <label>{{ price.label }}</label>
            </div>
          </div>
        </div>

      </div>
    </aside>

  </div>

</div>