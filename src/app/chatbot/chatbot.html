<div class="chatbot-wrapper">
  <!-- ุฃููููุฉ ุงูุจูุจ ุขุจ (ุงูุธุงูุฑุฉ ุฏุงุฆูุงู) -->
  <div class="chatbot-toggle-btn" 
       [class.hidden]="isChatOpen"
       (click)="toggleChat()"
       title="ูุชุญ ูุณุงุนุฏ ุงูุจุญุซ ุนู ุงูุนูุงุฑุงุช">
    <div class="chatbot-icon">๐ฌ</div>
    <div class="pulse-ring"></div>
  </div>

  <!-- ูุงูุฐุฉ ุงูุฏุฑุฏุดุฉ -->
  <div class="chatbot-container" [class.open]="isChatOpen">
    <div class="chat-header">
      <div class="header-content">
        <div class="header-icon"></div>
        <div>
          <h2>ูุฑุญุจุงู ุงูุง  ุดุงูู ูู ูููููู ูุณุงุนุฏุชู</h2>
          <p class="header-subtitle">ุงุจุญุซ ุนู ุนูุงุฑู ุงููุซุงูู ุจุณูููุฉ</p>
        </div>
      </div>
      <div class="header-actions">
        <button class="btn-small" (click)="initEmbeddings()" [disabled]="isBusy || embeddingsReady" title="ุฅุนุงุฏุฉ ูุญุงููุฉ ุงูุชููุฆุฉ" *ngIf="!embeddingsReady">
          <span class="btn-icon">โ๏ธ</span> ุฅุนุงุฏุฉ ูุญุงููุฉ
        </button>
        <button class="btn-small" (click)="checkStatus()" [disabled]="isBusy" title="ุงูุชุญูู ูู ุญุงูุฉ ุงููุธุงู" *ngIf="!embeddingsReady">
          <span class="btn-icon">๐</span> ุงูุญุงูุฉ
        </button>
        <div class="header-status" *ngIf="embeddingsReady" [class.ready]="embeddingsReady">
          <span class="status-dot"></span>
          <span>ุฌุงูุฒ</span>
        </div>
        <button class="btn-close" (click)="closeChat()" title="ุฅุบูุงู ุงูุฏุฑุฏุดุฉ">โ</button>
      </div>
    </div>

    <div class="messages-container" #messagesContainer>
      <div *ngIf="messages.length === 0" class="welcome-message">
        <div class="welcome-icon">๐</div>
        <h3>  ูุฑุญุจุงู ุจู! ุงูุง ุดุงูู</h3>
        <p>ุฃูุง ูุณุงุนุฏุชู ูู ุงูุจุญุซ ุนู ุงูุนูุงุฑุงุช ุงูููุงุณุจุฉ</p>
        <div class="welcome-tips">
          <div class="tip">๐ ุญุฏุฏ ุงููููุน ุงูุฐู ุชูุถูู</div>
          <div class="tip">๐ฐ ุญุฏุฏ ุงูุณุนุฑ ุงูููุงุณุจ</div>
          <div class="tip">๐ข ุงุฎุชุฑ ููุน ุงูุนูุงุฑ</div>
        </div>
      </div>

      <div *ngFor="let message of messages; let i = index" 
           [class]="message.isUser ? 'message user-message' : 'message bot-message'">
        <div class="message-content" [innerHTML]="formatMessage(message.text, message.isUser)"></div>
        <span class="message-time">{{ message.timestamp | date: 'HH:mm' }}</span>
      </div>

      <div *ngIf="isLoading" class="message bot-message">
        <div class="message-content">
          <div class="typing-indicator">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </div>
      </div>
    </div>

    <div class="input-container">
      <input 
        #messageInput
        type="text" 
        name="userInput"
        [(ngModel)]="userInput" 
        (keyup.enter)="sendMessage()"
        placeholder="ุงุจุญุซ ุนู ุนูุงุฑู... (ูุซุงู: ุดูุฉ 3 ุบุฑู ูู ุงููุงูุฑุฉ)"
        autocomplete="off"
        [disabled]="isLoading">
      <button class="send-btn" (click)="sendMessage()" [disabled]="!userInput.trim() || isLoading" title="ุฅุฑุณุงู ุงูุฑุณุงูุฉ">
        <span class="send-icon">โฌ</span>
      </button>
    </div>
  </div>
</div>